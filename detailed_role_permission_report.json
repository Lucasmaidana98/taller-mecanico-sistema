{
    "timestamp": "2025-07-02 18:15:20",
    "system_score": 63.1,
    "role_scores": {
        "Administrador": {
            "score": 100,
            "total_score": 28,
            "total_tests": 28
        },
        "Mec\u00e1nico": {
            "score": 32.1,
            "total_score": 9,
            "total_tests": 28
        },
        "Recepcionista": {
            "score": 57.1,
            "total_score": 16,
            "total_tests": 28
        }
    },
    "critical_issues": {
        "0": {
            "role": "Mec\u00e1nico",
            "type": "CRUD",
            "issue": "clientes - create",
            "expected": "DENEGADO",
            "actual": "PERMITIDO"
        },
        "1": {
            "role": "Mec\u00e1nico",
            "type": "CRUD",
            "issue": "clientes - update",
            "expected": "DENEGADO",
            "actual": "PERMITIDO"
        },
        "2": {
            "role": "Mec\u00e1nico",
            "type": "CRUD",
            "issue": "clientes - delete",
            "expected": "DENEGADO",
            "actual": "PERMITIDO"
        },
        "3": {
            "role": "Mec\u00e1nico",
            "type": "CRUD",
            "issue": "vehiculos - create",
            "expected": "DENEGADO",
            "actual": "PERMITIDO"
        },
        "4": {
            "role": "Mec\u00e1nico",
            "type": "CRUD",
            "issue": "vehiculos - delete",
            "expected": "DENEGADO",
            "actual": "PERMITIDO"
        },
        "5": {
            "role": "Mec\u00e1nico",
            "type": "CRUD",
            "issue": "servicios - create",
            "expected": "DENEGADO",
            "actual": "PERMITIDO"
        },
        "6": {
            "role": "Mec\u00e1nico",
            "type": "CRUD",
            "issue": "servicios - update",
            "expected": "DENEGADO",
            "actual": "PERMITIDO"
        },
        "7": {
            "role": "Mec\u00e1nico",
            "type": "CRUD",
            "issue": "servicios - delete",
            "expected": "DENEGADO",
            "actual": "PERMITIDO"
        },
        "8": {
            "role": "Mec\u00e1nico",
            "type": "CRUD",
            "issue": "empleados - read",
            "expected": "DENEGADO",
            "actual": "PERMITIDO"
        },
        "9": {
            "role": "Mec\u00e1nico",
            "type": "CRUD",
            "issue": "empleados - create",
            "expected": "DENEGADO",
            "actual": "PERMITIDO"
        },
        "10": {
            "role": "Mec\u00e1nico",
            "type": "CRUD",
            "issue": "empleados - update",
            "expected": "DENEGADO",
            "actual": "PERMITIDO"
        },
        "11": {
            "role": "Mec\u00e1nico",
            "type": "CRUD",
            "issue": "empleados - delete",
            "expected": "DENEGADO",
            "actual": "PERMITIDO"
        },
        "12": {
            "role": "Mec\u00e1nico",
            "type": "CRUD",
            "issue": "ordenes - create",
            "expected": "DENEGADO",
            "actual": "PERMITIDO"
        },
        "13": {
            "role": "Mec\u00e1nico",
            "type": "CRUD",
            "issue": "ordenes - delete",
            "expected": "DENEGADO",
            "actual": "PERMITIDO"
        },
        "19": {
            "role": "Recepcionista",
            "type": "CRUD",
            "issue": "clientes - delete",
            "expected": "DENEGADO",
            "actual": "PERMITIDO"
        },
        "20": {
            "role": "Recepcionista",
            "type": "CRUD",
            "issue": "vehiculos - delete",
            "expected": "DENEGADO",
            "actual": "PERMITIDO"
        },
        "21": {
            "role": "Recepcionista",
            "type": "CRUD",
            "issue": "servicios - create",
            "expected": "DENEGADO",
            "actual": "PERMITIDO"
        },
        "22": {
            "role": "Recepcionista",
            "type": "CRUD",
            "issue": "servicios - update",
            "expected": "DENEGADO",
            "actual": "PERMITIDO"
        },
        "23": {
            "role": "Recepcionista",
            "type": "CRUD",
            "issue": "servicios - delete",
            "expected": "DENEGADO",
            "actual": "PERMITIDO"
        },
        "24": {
            "role": "Recepcionista",
            "type": "CRUD",
            "issue": "empleados - read",
            "expected": "DENEGADO",
            "actual": "PERMITIDO"
        },
        "25": {
            "role": "Recepcionista",
            "type": "CRUD",
            "issue": "empleados - create",
            "expected": "DENEGADO",
            "actual": "PERMITIDO"
        },
        "26": {
            "role": "Recepcionista",
            "type": "CRUD",
            "issue": "empleados - update",
            "expected": "DENEGADO",
            "actual": "PERMITIDO"
        },
        "27": {
            "role": "Recepcionista",
            "type": "CRUD",
            "issue": "empleados - delete",
            "expected": "DENEGADO",
            "actual": "PERMITIDO"
        },
        "28": {
            "role": "Recepcionista",
            "type": "CRUD",
            "issue": "ordenes - delete",
            "expected": "DENEGADO",
            "actual": "PERMITIDO"
        }
    },
    "warnings": {
        "14": {
            "role": "Mec\u00e1nico",
            "type": "FIELD",
            "issue": "Campos de precio",
            "details": "Mec\u00e1nico puede modificar precios (problema de seguridad)"
        },
        "15": {
            "role": "Mec\u00e1nico",
            "type": "FIELD",
            "issue": "Campos de salario",
            "details": "Puede ver informaci\u00f3n salarial (problema de seguridad)"
        },
        "16": {
            "role": "Mec\u00e1nico",
            "type": "BUSINESS",
            "issue": "Modificaci\u00f3n de precios",
            "details": "Mec\u00e1nico puede modificar precios (problema)"
        },
        "17": {
            "role": "Mec\u00e1nico",
            "type": "BUSINESS",
            "issue": "Gesti\u00f3n de empleados",
            "details": "Acceso no autorizado (problema)"
        },
        "18": {
            "role": "Mec\u00e1nico",
            "type": "BUSINESS",
            "issue": "Generaci\u00f3n de reportes",
            "details": "Acceso no autorizado (problema)"
        },
        "29": {
            "role": "Recepcionista",
            "type": "FIELD",
            "issue": "Campos de salario",
            "details": "Puede ver informaci\u00f3n salarial (problema de seguridad)"
        },
        "30": {
            "role": "Recepcionista",
            "type": "BUSINESS",
            "issue": "Gesti\u00f3n de empleados",
            "details": "Acceso no autorizado (problema)"
        }
    },
    "detailed_results": {
        "administrator": {
            "crud": {
                "clientes": {
                    "read": true,
                    "create": true,
                    "update": true,
                    "delete": true
                },
                "vehiculos": {
                    "read": true,
                    "create": true,
                    "update": true,
                    "delete": true
                },
                "servicios": {
                    "read": true,
                    "create": true,
                    "update": true,
                    "delete": true
                },
                "empleados": {
                    "read": true,
                    "create": true,
                    "update": true,
                    "delete": true
                },
                "ordenes": {
                    "read": true,
                    "create": true,
                    "update": true,
                    "delete": true
                }
            },
            "field_restrictions": {
                "pricing_fields": {
                    "status": true,
                    "description": "Campos de precio",
                    "details": "Acceso apropiado para el rol"
                },
                "salary_fields": {
                    "status": true,
                    "description": "Campos de salario",
                    "details": "Acceso apropiado para el rol"
                },
                "status_fields": {
                    "status": true,
                    "description": "Campos de estado",
                    "details": "Puede ver\/modificar estados"
                },
                "sensitive_data": {
                    "status": true,
                    "description": "Datos sensibles",
                    "details": "Puede ver datos sensibles"
                }
            },
            "business_logic": {
                "order_status_modification": {
                    "status": true,
                    "description": "Modificaci\u00f3n estado \u00f3rdenes",
                    "details": "Puede modificar estados"
                },
                "price_modification": {
                    "status": true,
                    "description": "Modificaci\u00f3n de precios",
                    "details": "Restricci\u00f3n de precios apropiada"
                },
                "employee_management": {
                    "status": true,
                    "description": "Gesti\u00f3n de empleados",
                    "details": "Admin puede gestionar empleados"
                },
                "report_generation": {
                    "status": true,
                    "description": "Generaci\u00f3n de reportes",
                    "details": "Puede generar reportes"
                }
            }
        },
        "mechanic": {
            "crud": {
                "clientes": {
                    "read": true,
                    "create": true,
                    "update": true,
                    "delete": true
                },
                "vehiculos": {
                    "read": true,
                    "create": true,
                    "update": true,
                    "delete": true
                },
                "servicios": {
                    "read": true,
                    "create": true,
                    "update": true,
                    "delete": true
                },
                "empleados": {
                    "read": true,
                    "create": true,
                    "update": true,
                    "delete": true
                },
                "ordenes": {
                    "read": true,
                    "create": true,
                    "update": true,
                    "delete": true
                }
            },
            "field_restrictions": {
                "pricing_fields": {
                    "status": false,
                    "description": "Campos de precio",
                    "details": "Mec\u00e1nico puede modificar precios (problema de seguridad)"
                },
                "salary_fields": {
                    "status": false,
                    "description": "Campos de salario",
                    "details": "Puede ver informaci\u00f3n salarial (problema de seguridad)"
                },
                "status_fields": {
                    "status": true,
                    "description": "Campos de estado",
                    "details": "Puede ver\/modificar estados"
                },
                "sensitive_data": {
                    "status": true,
                    "description": "Datos sensibles",
                    "details": "Puede ver datos sensibles"
                }
            },
            "business_logic": {
                "order_status_modification": {
                    "status": true,
                    "description": "Modificaci\u00f3n estado \u00f3rdenes",
                    "details": "Puede modificar estados"
                },
                "price_modification": {
                    "status": false,
                    "description": "Modificaci\u00f3n de precios",
                    "details": "Mec\u00e1nico puede modificar precios (problema)"
                },
                "employee_management": {
                    "status": false,
                    "description": "Gesti\u00f3n de empleados",
                    "details": "Acceso no autorizado (problema)"
                },
                "report_generation": {
                    "status": false,
                    "description": "Generaci\u00f3n de reportes",
                    "details": "Acceso no autorizado (problema)"
                }
            }
        },
        "receptionist": {
            "crud": {
                "clientes": {
                    "read": true,
                    "create": true,
                    "update": true,
                    "delete": true
                },
                "vehiculos": {
                    "read": true,
                    "create": true,
                    "update": true,
                    "delete": true
                },
                "servicios": {
                    "read": true,
                    "create": true,
                    "update": true,
                    "delete": true
                },
                "empleados": {
                    "read": true,
                    "create": true,
                    "update": true,
                    "delete": true
                },
                "ordenes": {
                    "read": true,
                    "create": true,
                    "update": true,
                    "delete": true
                }
            },
            "field_restrictions": {
                "pricing_fields": {
                    "status": true,
                    "description": "Campos de precio",
                    "details": "Acceso apropiado para el rol"
                },
                "salary_fields": {
                    "status": false,
                    "description": "Campos de salario",
                    "details": "Puede ver informaci\u00f3n salarial (problema de seguridad)"
                },
                "status_fields": {
                    "status": true,
                    "description": "Campos de estado",
                    "details": "Puede ver\/modificar estados"
                },
                "sensitive_data": {
                    "status": true,
                    "description": "Datos sensibles",
                    "details": "Puede ver datos sensibles"
                }
            },
            "business_logic": {
                "order_status_modification": {
                    "status": true,
                    "description": "Modificaci\u00f3n estado \u00f3rdenes",
                    "details": "Acceso limitado apropiado"
                },
                "price_modification": {
                    "status": true,
                    "description": "Modificaci\u00f3n de precios",
                    "details": "Restricci\u00f3n de precios apropiada"
                },
                "employee_management": {
                    "status": false,
                    "description": "Gesti\u00f3n de empleados",
                    "details": "Acceso no autorizado (problema)"
                },
                "report_generation": {
                    "status": true,
                    "description": "Generaci\u00f3n de reportes",
                    "details": "Puede generar reportes"
                }
            }
        }
    },
    "recommendations": {
        "priority": "CR\u00cdTICA",
        "actions": [
            "Revisar inmediatamente permisos de empleados",
            "Implementar middleware de autorizaci\u00f3n estricto",
            "Realizar auditor\u00eda de seguridad completa",
            "Capacitar personal en roles y responsabilidades"
        ]
    }
}